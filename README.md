
# Текстовый анализатор

## Описание проекта

Данное веб-приложение представляет собой "текстовый сканер", который принимает на вход текстовые файлы (в формате .txt) и выполняет их анализ:

1. Подсчет статистики:
   - Количество абзацев
   - Количество слов
   - Количество символов
2. Визуализация данных в виде облака слов (word cloud)

## Архитектура системы

Проект реализован с использованием микросервисной архитектуры, состоящей из трех компонентов:

### 1. API Gateway

- Отвечает за маршрутизацию запросов от клиентов к соответствующим микросервисам
- Предоставляет единую точку входа для взаимодействия с системой
- Обрабатывает ошибки, если какой-либо из микросервисов недоступен

### 2. File Storage Service

- Отвечает за хранение и выдачу файлов
- Управляет загрузкой текстовых документов
- Хранит файлы на диске и их метаданные в базе данных PostgreSQL
- Обеспечивает дедупликацию файлов (использует хеширование SHA-256)

### 3. File Analysis Service

- Отвечает за проведение анализа текстовых файлов
- Хранит результаты анализа в своей базе данных PostgreSQL
- Генерирует облака слов и сохраняет их как SVG-изображения
- Предоставляет API для получения результатов анализа

## Спецификация API

### API Gateway

#### 1. Загрузка файла

- **Endpoint**: `POST /api/TextAnalysis/upload-file`
- **Content-Type**: `multipart/form-data`
- **Параметры**: 
  - `file`: текстовый файл (формат .txt)
- **Ответ**: JSON с ID файла
  ```json
  { "id": "guid-идентификатор" }
  ```

#### 2. Получение файла

- **Endpoint**: `GET /api/TextAnalysis/download-file/{id}`
- **Параметры**: 
  - `id`: GUID идентификатор файла
- **Ответ**: Текстовый файл

#### 3. Анализ файла

- **Endpoint**: `GET /api/TextAnalysis/analysis-file/{id}`
- **Параметры**: 
  - `id`: GUID идентификатор файла
- **Ответ**: JSON с результатами анализа
  ```json
  {
    "paragraphCount": 10,
    "wordCount": 500,
    "characterCount": 3000,
    "wordCloudAvailable": true
  }
  ```

#### 4. Получение облака слов

- **Endpoint**: `GET /api/TextAnalysis/word-cloud/{id}`
- **Параметры**: 
  - `id`: GUID идентификатор файла
- **Ответ**: SVG-изображение облака слов

### File Storage Service

#### 1. Загрузка файла

- **Endpoint**: `POST /api/Files`
- **Content-Type**: `multipart/form-data`
- **Параметры**: 
  - `file`: текстовый файл (формат .txt)
- **Ответ**: JSON с ID файла
  ```json
  { "id": "guid-идентификатор" }
  ```

#### 2. Получение файла

- **Endpoint**: `GET /api/Files/{id}`
- **Параметры**: 
  - `id`: GUID идентификатор файла
- **Ответ**: Текстовый файл

### File Analysis Service

#### 1. Анализ файла

- **Endpoint**: `GET /api/Analysis/analysis-file/{id}`
- **Параметры**: 
  - `id`: GUID идентификатор файла
- **Ответ**: JSON с результатами анализа
  ```json
  {
    "paragraphCount": 10,
    "wordCount": 500,
    "characterCount": 3000
  }
  ```

#### 2. Получение облака слов

- **Endpoint**: `GET /api/Analysis/word-cloud/{id}`
- **Параметры**: 
  - `id`: GUID идентификатор файла
- **Ответ**: SVG-изображение облака слов

## Запуск проекта

Проект контейнеризирован с использованием Docker и Docker Compose:

```
docker-compose up
```

После запуска, сервисы будут доступны по следующим адресам:
- API Gateway: http://localhost:5001
- File Storage Service: http://localhost:5002
- File Analysis Service: http://localhost:5003

Документация API доступна через Swagger UI:
- http://localhost:5001/swagger
- http://localhost:5002/swagger
- http://localhost:5003/swagger